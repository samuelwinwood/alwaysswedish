<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Paddy's Pub: Swedish Juice</title>
    <style>
        :root {
            --paddys-bg: #0d1a0d;
            --paddys-green: #386641;
            --sunny-yellow: #ffdf00;
            --error-red: #bc4749;
            --card-white: #f2e8cf;
            --font-main: 'Marker Felt', 'Avenir Next', sans-serif;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; }

        body {
            font-family: var(--font-main);
            background-color: var(--paddys-bg);
            background-image: radial-gradient(#1a331a 10%, transparent 10%);
            background-size: 30px 30px;
            margin: 0;
            display: flex;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden; /* Prevents bounce scrolling on iOS */
            touch-action: none;
        }

        #app {
            width: 100%;
            max-width: 440px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
        }

        /* Juicy UI Header */
        .header {
            display: flex;
            width: 100%;
            justify-content: space-between;
            margin-bottom: 15px;
            perspective: 500px;
        }

        .stat-card {
            background: #000;
            color: var(--sunny-yellow);
            padding: 10px 15px;
            border-radius: 10px;
            border: 3px solid var(--paddys-green);
            box-shadow: 5px 5px 0 var(--sunny-yellow);
            font-weight: 900;
            font-size: 0.9rem;
            transform: rotateX(10deg);
        }

        /* The Animated Progress Bar */
        .progress-container {
            width: 100%;
            height: 20px;
            background: #222;
            border: 3px solid #000;
            border-radius: 50px;
            margin-bottom: 25px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.5);
        }
        #progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--sunny-yellow), #ffa500);
            box-shadow: 0 0 15px var(--sunny-yellow);
            transition: width 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* The Main Action Card */
        .game-card {
            background: var(--card-white);
            border-radius: 25px;
            padding: 35px 20px;
            width: 100%;
            border: 6px solid #222;
            box-shadow: 12px 12px 0 rgba(0,0,0,0.4);
            text-align: center;
            position: relative;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .topic-badge {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%) rotate(-2deg);
            background: var(--paddys-green);
            color: white;
            padding: 8px 25px;
            border-radius: 5px;
            font-size: 1rem;
            border: 4px solid #000;
            box-shadow: 4px 4px 0 #000;
            z-index: 5;
        }

        .en-translation {
            color: var(--light);
            font-size: 1.3rem;
            margin-bottom: 15px;
            opacity: 0.7;
            font-style: italic;
        }

        .sv-sentence {
            font-size: 2.1rem;
            font-weight: 900;
            line-height: 1.3;
            margin-bottom: 30px;
            color: #111;
        }

        .blank-space {
            display: inline-block;
            min-width: 140px;
            border-bottom: 6px dashed #aaa;
            height: 1.4em;
            vertical-align: bottom;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        .blank-space.filled {
            border-bottom: 6px solid var(--paddys-green);
            color: var(--paddys-green);
            animation: bounceIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* Word Bank (The Juice) */
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            margin-top: 20px;
            min-height: 160px;
        }

        .word-tile {
            background: #fff;
            padding: 12px 20px;
            border-radius: 12px;
            font-weight: 900;
            font-size: 1.2rem;
            border: 4px solid #000;
            box-shadow: 5px 5px 0 #000;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        .word-tile:active {
            transform: scale(0.9) translate(3px, 3px);
            box-shadow: 0px 0px 0 #000;
        }
        .word-tile.hidden { display: none; }

        /* The Big Paddy's Button */
        .btn-action {
            width: 100%;
            background: var(--sunny-yellow);
            color: #000;
            border: 5px solid #000;
            border-radius: 15px;
            padding: 20px;
            font-size: 1.8rem;
            font-weight: 900;
            box-shadow: 0 10px 0 #000;
            cursor: pointer;
            margin-top: 25px;
            transition: all 0.1s;
        }
        .btn-action:active {
            transform: translateY(6px);
            box-shadow: 0 4px 0 #000;
        }
        .btn-action.win {
            background: #aacc00;
            color: white;
            animation: jelly 0.6s infinite;
        }

        /* Animations */
        @keyframes bounceIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes jelly {
            0%, 100% { transform: scale(1, 1); }
            30% { transform: scale(1.1, 0.9); }
            60% { transform: scale(0.9, 1.1); }
        }
        @keyframes shake {
            0%, 100% { transform: translate(0,0) rotate(0); }
            20% { transform: translate(-10px, 0) rotate(-2deg); }
            40% { transform: translate(10px, 0) rotate(2deg); }
            60% { transform: translate(-10px, 0) rotate(-2deg); }
            80% { transform: translate(10px, 0) rotate(2deg); }
        }
        .shake { animation: shake 0.4s ease-in-out; }

        /* Confetti elements */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            z-index: 100;
            pointer-events: none;
        }

        #feedback-text {
            font-size: 1.5rem;
            font-weight: 900;
            height: 35px;
            margin-bottom: 10px;
        }
    </style>
</head>
<body onclick="resumeAudio()">

<div id="app">
    <div class="header">
        <div class="stat-card" id="streak">Streak: 0 ðŸ”¥</div>
        <div class="stat-card" id="stars">Milk-Steaks: 0 ðŸ¥©</div>
    </div>

    <div class="progress-container"><div id="progress-fill"></div></div>

    <div class="game-card" id="main-card">
        <div class="topic-badge" id="topic">THE GANG</div>
        <div class="en-translation" id="en-text">...</div>
        <div class="sv-sentence" id="sv-text"></div>
        
        <div id="feedback-text"></div>

        <div class="word-bank" id="bank"></div>
    </div>

    <button id="btn-main" class="btn-action">CHECK ANSWER</button>
    
    <div style="display: flex; width: 100%; gap: 10px; margin-top: 15px;">
        <button id="btn-audio" style="flex: 1; padding: 15px; background: #333; color: white; border: 3px solid #000; border-radius: 10px; font-weight: 900;">ðŸ”Š LISTEN</button>
        <button id="btn-hint" style="flex: 1; padding: 15px; background: #333; color: white; border: 3px solid #000; border-radius: 10px; font-weight: 900;">ðŸ’¡ HINT</button>
    </div>
</div>

<script>
// PADDY'S PUB DATABASE
const DB = [
    {en: "Dee is a big bird.", sv: "Dee Ã¤r en stor __.", ans: "fÃ¥gel", bank: "fÃ¥gel|hund|katt|bil", hint: "Shut up, Dee!", topic: "THE GANG"},
    {en: "I want a milksteak.", sv: "Jag vill ha en __.", ans: "mjÃ¶lkbiff", bank: "mjÃ¶lkbiff|ost|korv|fisk", hint: "Boiled over hard.", topic: "FOOD"},
    {en: "I am the trash man.", sv: "Jag Ã¤r __.", ans: "sopgubben", bank: "sopgubben|kungen|hjÃ¤lten|fÃ¥geln", hint: "I eat trash!", topic: "FRANK"},
    {en: "Because of the implication.", sv: "PÃ¥ grund av __.", ans: "implikationen", bank: "implikationen|planen|idÃ©n|felet", hint: "Dennis on a boat.", topic: "THE OCEAN"},
    {en: "Charlie knows bird law.", sv: "Charlie kan __.", ans: "fÃ¥gelrÃ¤tt", bank: "fÃ¥gelrÃ¤tt|svenska|skolan|bilen", hint: "Legal advice from a janitor.", topic: "CHARLIE"},
    {en: "Danny DeVito is short.", sv: "Danny DeVito Ã¤r __.", ans: "kort", bank: "kort|lÃ¥ng|blÃ¥|stor", hint: "The opposite of tall.", topic: "FRANK"},
    {en: "An egg in this trying time?", sv: "Ett __ i denna prÃ¶vande tid?", ans: "Ã¤gg", bank: "Ã¤gg|Ã¤pple|brÃ¶d|vin", hint: "Frank's medical gift.", topic: "FRANK"},
    {en: "Wild card, bitches!", sv: "Vildkort, __!", ans: "Ã¤lsklingar", bank: "Ã¤lsklingar|vÃ¤nner|fÃ¥glar|idioter", hint: "Jumping from a van.", topic: "CHARLIE"},
    {en: "I found a rum ham!", sv: "Jag hittade en __!", ans: "romskinka", bank: "romskinka|Ã¶l|vÃ¤ska|hund", hint: "Floating in the ocean.", topic: "HOLIDAY"},
    {en: "Is your cat making too much noise?", sv: "GÃ¶r din __ fÃ¶r mycket ljud?", ans: "katt", bank: "katt|hund|fÃ¥gel|rÃ¥tta", hint: "Kitten Mittons!", topic: "CHARLIE"},
    {en: "The Nightman cometh.", sv: "Nattmannen __.", ans: "kommer", bank: "kommer|gÃ¥r|sover|sjunger", hint: "Dayman's rival.", topic: "THE GANG"},
    {en: "I am a golden god.", sv: "Jag Ã¤r en __.", ans: "guldgud", bank: "guldgud|stjÃ¤rna|kung|man", hint: "Dennis at his peak.", topic: "DENNIS"},
    {en: "We need a boat.", sv: "Vi behÃ¶ver en __.", ans: "bÃ¥t", bank: "bÃ¥t|bil|cykel|tÃ¥g", hint: "For the implication.", topic: "THE OCEAN"},
    {en: "Drink your milk.", sv: "Drick din __.", ans: "mjÃ¶lk", bank: "mjÃ¶lk|Ã¶l|vatten|vin", hint: "Warm McPoyle style.", topic: "FOOD"},
    {en: "Rum ham!", sv: "Romskinka!", sv_blank: "__!", ans: "Romskinka", bank: "Romskinka|Skinka|Biff|Korv", hint: "Frank's favorite.", topic: "FOOD"}
];

let state = { cur: null, placed: null, streak: 0, stars: 0, tries: 0 };

function init() {
    const saved = JSON.parse(localStorage.getItem('sunny_juice') || '{}');
    state.streak = saved.s || 0; state.stars = saved.t || 0;
    setup();
    next();
}

function next() {
    state.cur = DB[Math.floor(Math.random() * DB.length)];
    state.placed = null; state.tries = 0;
    
    document.getElementById('main-card').className = 'game-card';
    document.getElementById('en-text').innerText = state.cur.en;
    document.getElementById('topic').innerText = state.cur.topic;
    document.getElementById('feedback-text').innerText = '';
    
    const btn = document.getElementById('btn-main');
    btn.innerText = "CHECK ANSWER";
    btn.className = "btn-action";

    const container = document.getElementById('sv-text');
    container.innerHTML = '';
    const parts = state.cur.sv.split('__');
    container.append(parts[0]);
    const blank = document.createElement('span');
    blank.className = 'blank-space';
    blank.id = 'target-blank';
    blank.onclick = () => state.placed && remove();
    container.append(blank, parts[1] || '');

    const bank = document.getElementById('bank');
    bank.innerHTML = '';
    state.cur.bank.split('|').sort(() => Math.random() - 0.5).forEach(w => {
        const t = document.createElement('div');
        t.className = 'word-tile';
        t.innerText = w;
        t.onclick = () => place(w);
        bank.append(t);
    });
    updateUI();
}

function place(w) {
    if (state.placed) remove();
    state.placed = w;
    const b = document.getElementById('target-blank');
    b.innerText = w;
    b.className = 'blank-space filled';
    Array.from(document.querySelectorAll('.word-tile')).find(t => t.innerText === w).classList.add('hidden');
    speak(w);
}

function remove() {
    const w = state.placed;
    state.placed = null;
    const b = document.getElementById('target-blank');
    b.innerText = '';
    b.className = 'blank-space';
    Array.from(document.querySelectorAll('.word-tile')).find(t => t.innerText === w).classList.remove('hidden');
}

function check() {
    if (!state.placed) return;
    const isWin = state.placed.toLowerCase() === state.cur.ans.toLowerCase();
    
    if (isWin) {
        state.stars++;
        if (state.tries === 0) state.streak++;
        document.getElementById('feedback-text').innerText = "ROCK, FLAG AND EAGLE! ðŸ¦…";
        document.getElementById('feedback-text').style.color = "#386641";
        const btn = document.getElementById('btn-main');
        btn.innerText = "NEXT ROUND â†’";
        btn.className = "btn-action win";
        createConfetti();
        save();
        speak(state.cur.sv.replace('__', state.placed));
    } else {
        state.tries++; state.streak = 0;
        document.getElementById('feedback-text').innerText = "YOU JABRONI!";
        document.getElementById('feedback-text').style.color = "red";
        const card = document.getElementById('main-card');
        card.classList.add('shake');
        setTimeout(() => card.classList.remove('shake'), 400);
    }
    updateUI();
}

function createConfetti() {
    for(let i=0; i<30; i++) {
        const c = document.createElement('div');
        c.className = 'confetti';
        c.style.left = Math.random() * 100 + 'vw';
        c.style.top = '-10px';
        c.style.backgroundColor = ['#ffdf00','#386641','#bc4749','#fff'][Math.floor(Math.random()*4)];
        document.body.appendChild(c);
        
        const animation = c.animate([
            { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
            { transform: `translate(${Math.random()*100 - 50}px, 100vh) rotate(${Math.random()*360}deg)`, opacity: 0 }
        ], { duration: 1000 + Math.random()*2000, easing: 'cubic-bezier(0, .9, .57, 1)' });
        
        animation.onfinish = () => c.remove();
    }
}

function speak(t) {
    const u = new SpeechSynthesisUtterance(t);
    u.lang = 'sv-SE'; u.rate = 0.9;
    speechSynthesis.speak(u);
}

function resumeAudio() { if (speechSynthesis.paused) speechSynthesis.resume(); }

function updateUI() {
    document.getElementById('streak').innerText = `Streak: ${state.streak} ðŸ”¥`;
    document.getElementById('stars').innerText = `Milk-Steaks: ${state.stars} ðŸ¥©`;
    document.getElementById('progress-fill').style.width = Math.min((state.stars / 20) * 100, 100) + '%';
}

function save() { localStorage.setItem('sunny_juice', JSON.stringify({s: state.streak, t: state.stars})); }

function setup() {
    document.getElementById('btn-main').onclick = () => {
        if (document.getElementById('btn-main').classList.contains('win')) next();
        else check();
    };
    document.getElementById('btn-audio').onclick = () => speak(state.cur.sv.replace('__', state.placed || '...'));
    document.getElementById('btn-hint').onclick = () => {
        document.getElementById('feedback-text').innerText = state.cur.hint;
        document.getElementById('feedback-text').style.color = "#333";
    };
}

init();
</script>
</body>
</html>